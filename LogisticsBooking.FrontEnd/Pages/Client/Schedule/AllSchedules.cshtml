@page "{id}"
@using LogisticsBooking.FrontEnd.DataServices.Models
@model LogisticsBooking.FrontEnd.Pages.Client.Schedule.AllSchedules

<head>
    <style>
                td.details-control {
                    text-align:center;
                    color:forestgreen;
            cursor: pointer;
        }
        tr.shown td.details-control {
            text-align:center; 
            color:red;
        }
    </style>
</head>


        <table style="background-color: white;" id="example" class="display table table-hover" width="100%" >
            <thead>
            <tr>
             <th scope="col">Navn</th>
                <th scope="col">Navn</th>
                <th scope="col">Dag</th>
            </tr>
            </thead>
        </table>




@section Scripts{


    <script src="https://cdn.datatables.net/1.10.15/js/dataTables.bootstrap4.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.24.0/moment.min.js"></script>


 <script>
    $(document).ready(function() {
       var table = $('#example').DataTable( {
           "processing": true,
           "serverSide": false,
               "ajax": {
                               "url": "AllSchedules?handler=test",
                               "type": "GET",
                               "datatype": "application/json",
                               "dataSrc": "schedules",
                               
                           },
                           
               "columns": [
                   {
                                        "className": 'details-control',
                                        "orderable": false,
                                        "data": null,
                                        "defaultContent": '',
                                        "render": function () {
                                            return '<i class="fa fa-plus-square" aria-hidden="true"></i>';
                                        },
                                        width:"15px"
                                    },
                   { 
                       "data": "scheduleDay" , render: function(data ) {
                           return moment(data).format("dddd DD MM");
                       }
                   },
                   { "data": "name" },
                   { "data": "scheduleId" , "visible": false}
               ]
           } );
       
      
            
    // Add event listener for opening and closing details
         $('#example tbody').on('click', 'td.details-control', function () {
             var tr = $(this).closest('tr');
             var tdi = tr.find("i.fa");
             var row = table.row(tr);

             if (row.child.isShown()) {
                 // This row is already open - close it
                 row.child.hide();
                 tr.removeClass('shown');
                 tdi.first().removeClass('fa-minus-square');
                 tdi.first().addClass('fa-plus-square');
             }
             else {
                 // Open this row
                 row.child(format(row.data())).show();
                 tr.addClass('shown');
                 tdi.first().removeClass('fa-plus-square');
                 tdi.first().addClass('fa-minus-square');
             }
         });

         table.on("user-select", function (e, dt, type, cell, originalEvent) {
             if ($(cell.node()).hasClass("details-control")) {
                 e.preventDefault();
             }
         });
    } );
    

    
    function format(d){
            
             // `d` is the original data object for the row
             return '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">' +
                 '<tr>' +
                     '<td>Full name:</td>' +
                     '<td>' + d.scheduleId + '</td>' +
                 '</tr>' +
                 '<tr>' +
                     '<td>Extension number:</td>' +
                     '<td>' + d.extn + '</td>' +
                 '</tr>' +
                 '<tr>' +
                     '<td>Extra info:</td>' +
                     '<td>And any further details here (images etc)...</td>' +
                 '</tr>' +
             '</table>';  
        }
    
 

    </script>

}